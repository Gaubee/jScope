{"version":3,"sources":["/source/jScope.min.js","jScope.min.js"],"names":["_ReturnThisV","factory","define","amd","root","exports","exp","Object","create","k","global","window","this","$Push","arr","item","length","$ForEach","cb","i","len","$Slice","start_index","end_index","_slice","call","$Remove","index","indexOf","splice","$HasAndGet","obj","key","hasOwnProperty","$IsOwn","_hasOwnPro","$InsOf","Con","$UID","prefix","Math","random","toString","substr","$Create","proto","PROTO","__PROTOTYPE","$LastItem","V","valueOf","_ReturnThisVString","$Base","_BaseTypeCusMap","_Undefined_AND_Null_TypeError","TypeError","Scope","ref_obj","options","self","id","E","C","R","store","O","$Object","setParent","parent","returner","B","onerror","_GlobalFunction","on","_ScopeNormalGet","unpack","has","P","get","_ScopeTopGet","_ScopeNormalSet","value","set","_ScopeTopSet","_ScopeNormalTypeOf","TypeOf","_ScopeTopTypeOf","_ScopeNormalDel","Del","_ScopeTopDel","_DestroyedHandle","ReferenceError","$$Boolean","v","$Boolean","$true","$false","$$Function","fun","args","A","$Function","$$Null","$Null","$null","$$Number","$Number","isNaN","$NaN","Infinity","$Infinity","$_Infinity","$$Object","G","S","_$$Object_Mix_HasProp","_$$Object_Mix_GetProp","getter","res","_$$Object_Mix_SetProp","data","config","setter","assignPropConfig","old_config","new_config","res_config","$$String","$String","$$Undefined","$Undefined","$undefined","__VALUEOF","__TOSTRING","Function","_GlobalObject","Array","TRUE","RegExp","FALSE","slice","String","Base","string","boolean","number","function","undefined","object","_$BaseProto","constructor","TypeofValue","destory","equal","like","jScope","__ScopePrototype","prototype","eventName","eventHandle","events","off","emit","eventList","arguments","handle","apply","push","scope_name","child_scope","C_SP","pop","csp","destroy","Var","funName","current","Boolean","__$$FunctionProperty","run","ctx","Null","__$$NullProperty","Number","NaN","getProp","__$$ObjectProperty","writable","configurable","enumerable","defGet","defSet","def","__$$StringPrototype","isFinite","charAt","Undefined","__$$UndefinedProperty"],"mappings":"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","file":"jScope.min.js","sourcesContent":["(function (root, factory) {\r\n\tif (typeof define === 'function' && define.amd) {\r\n\t\tdefine([], function () {\r\n\t\t\treturn factory(root);\r\n\t\t});\r\n\t} else if (typeof exports === 'object') {\r\n\t\tvar exp = Object.create(null);\r\n\t\tfactory(exp);\r\n\t\tfor (var k in exp) {\r\n\t\t\tdebugger\r\n\t\t\texports[k] = root[k] = exp[k];\r\n\t\t}\r\n\t} else {\r\n\t\tfactory(root);\r\n\t}\r\n} (typeof global != 'undefined' ? global : typeof window != 'undefined' ? window : this, function (global) {\n/*\r\n * 更好的压缩率\r\n */\r\nvar __PROTOTYPE = \"prototype\";\r\nvar __VALUEOF = \"valueOf\";\r\nvar __TOSTRING = \"toString\";\r\nvar void_0;\r\nvar _GlobalFunction = Function;\r\nvar _GlobalArray = Array;\r\nvar _GlobalObject = Object;\r\nvar _GlobalRegExp = RegExp;\r\n\r\nvar TRUE = true;\r\nvar FALSE = false;\r\nvar NULL = null;\r\nvar UNDEFINED;\r\n// var NAN = NaN;\r\n// var INFINITY = Infinity;\r\n\r\nfunction $Push(arr, item) {\r\n\tarr[arr.length] = item;\r\n\treturn arr\r\n}\r\nfunction $Unshift(arr, item) {\r\n\tarr.unshift(item);\r\n\treturn arr\r\n};\r\n\r\nfunction $ForEach(arr, cb) {\r\n\tfor (var i = 0, len = arr.length; i < len; i += 1) {\r\n\t\tcb(arr[i], i)\r\n\t}\r\n}\r\n\r\nfunction $Map(arr, cb) {\r\n\tfor (var i = 0, len = arr.length, res = []; i < len; i += 1) {\r\n\t\t$Push(res, cb(arr[i], i))\r\n\t}\r\n\treturn res\r\n}\r\n\r\nfunction $Some(arr, cb) {\r\n\tfor (var i = 0, len = arr.length; i < len; i += 1) {\r\n\t\tif (cb(arr[i], i)) return TRUE\r\n\t}\r\n}\r\n\r\nvar _slice = Array[__PROTOTYPE].slice;\r\nvar __StringProto__ = String[__PROTOTYPE];\r\n\r\nfunction $Slice(arr, start_index, end_index) {\r\n\treturn _slice.call(arr, start_index, end_index);\r\n};\r\n\r\nfunction $Remove(arr, item) {\r\n\tvar index = arr.indexOf(item);\r\n\tindex !== -1 && arr.splice(index, 1);\r\n};\r\n\r\nfunction $HasAndGet(obj, key) {\r\n\treturn obj.hasOwnProperty(key) && obj[key];\r\n};\r\n\r\nvar _hasOwnPro = _GlobalObject.hasOwnProperty;\r\n\r\nfunction $IsOwn(obj, key) {\r\n\treturn _hasOwnPro.call(obj, key);\r\n};\r\n\r\nfunction $InsOf(obj, Con) {\r\n\treturn obj instanceof Con\r\n};\r\n\r\nfunction $IsString(str) {\r\n\treturn typeof str === \"string\"\r\n};\r\n\r\nfunction $IsNumber(num) {\r\n\treturn typeof num === \"number\"\r\n};\r\n\r\nfunction $IsBoolean(bool) {\r\n\treturn typeof bool === \"boolean\"\r\n};\r\n\r\nfunction $UID(prefix) {\r\n\treturn (prefix || \"\") + Math.random().toString(36).substr(2);\r\n};\r\n\r\nvar PROTO = _GlobalFunction();\r\n\r\nfunction $Create(proto) {\r\n\tPROTO[__PROTOTYPE] = proto;\r\n\treturn new PROTO;\r\n};\r\n\r\nfunction $LastItem(arr) {\r\n\treturn arr[arr.length - 1]\r\n};\r\n\r\nfunction noop() { }\r\n\r\n//将字符串反转义,同JSON.stringify(string)\r\nvar charIndexBuggy = \"a\"[0] != \"a\";\r\nvar Escapes = {\r\n\t92: \"\\\\\\\\\",\r\n\t34: '\\\\\"',\r\n\t8: \"\\\\b\",\r\n\t12: \"\\\\f\",\r\n\t10: \"\\\\n\",\r\n\t13: \"\\\\r\",\r\n\t9: \"\\\\t\"\r\n};\r\n\r\nfunction strStringify(value) {\r\n\tvar result = '\"',\r\n\t\tindex = 0,\r\n\t\tlength = value.length,\r\n\t\tuseCharIndex = !charIndexBuggy || length > 10;\r\n\tvar symbols = useCharIndex && (charIndexBuggy ? value.split(\"\") : value);\r\n\tfor (; index < length; index++) {\r\n\t\tvar charCode = value.charCodeAt(index);\r\n\t\t// If the character is a control character, append its Unicode or\r\n\t\t// shorthand escape sequence; otherwise, append the character as-is.\r\n\t\tswitch (charCode) {\r\n\t\t\tcase 8:\r\n\t\t\tcase 9:\r\n\t\t\tcase 10:\r\n\t\t\tcase 12:\r\n\t\t\tcase 13:\r\n\t\t\tcase 34:\r\n\t\t\tcase 92:\r\n\t\t\t\tresult += Escapes[charCode];\r\n\t\t\t\tbreak;\r\n\t\t\tdefault:\r\n\t\t\t\tif (charCode < 32) {\r\n\t\t\t\t\tresult += unicodePrefix + toPaddedString(2, charCode.toString(16));\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t\tresult += useCharIndex ? symbols[index] : value.charAt(index);\r\n\t\t}\r\n\t}\r\n\treturn result + '\"';\r\n};\nfunction _ReturnThisV() {\r\n\treturn this.V && this.V.valueOf();\r\n};\r\n\r\nfunction _ReturnThisVString() {\r\n\treturn this.V + \"\";\r\n};\r\n\r\nScope.Base = $Base;\r\n\r\nfunction $Base(obj) {\r\n\treturn $InsOf(obj, $Base) ? obj : _BaseTypeCusMap[typeof obj](obj)\r\n};\r\nvar _BaseTypeCusMap = {\r\n\t\"string\": $String,\r\n\t\"boolean\": $Boolean,\r\n\t\"number\": $Number,\r\n\t\"function\": $Function,\r\n\t\"undefined\": $Undefined,\r\n\t\"object\": function (v) {\r\n\t\treturn (v /*!== null */ ? $Object : $Null)(v)\r\n\t}\r\n};\r\n\r\nvar _$BaseProto = $Base[__PROTOTYPE] = {\r\n\thas: function (key) {\r\n\t\treturn $IsOwn(this.V, key)\r\n\t},\r\n\t//get Property\r\n\tget: function (key, unpack) {\r\n\t\tvar res = this.V[key];\r\n\t\t$InsOf(res, $Base) || (res = $undefined);// if false then\r\n\t\treturn unpack ? res.valueOf() : res\r\n\t},\r\n\t//set Property\r\n\tset: function (key, value) {\r\n\t\treturn this.V[key] = $Base(value);\r\n\t},\r\n\tTypeOf: function () {\r\n\t\treturn this.constructor.TypeofValue;\r\n\t},\r\n\tdestory: function () {\r\n\t\tdelete this.V;\r\n\t},\r\n\t// ===\r\n\tequal: function (obj) {\r\n\t\treturn this.V === ($InsOf(obj, $Base) ? obj.V : obj)\r\n\t},\r\n\tlike: function (obj) {\r\n\t\treturn this.V == ($InsOf(obj, $Base) ? obj.V : obj)\r\n\t}\r\n};\r\n_$BaseProto[__VALUEOF] = _ReturnThisV;\r\n_$BaseProto[__TOSTRING] = _ReturnThisVString;\r\n\r\n\r\nfunction _Undefined_AND_Null_TypeError() {\r\n\tthrow TypeError(\"Cannot convert undefined or null to object\");\r\n};\nglobal.jScope = Scope;\r\n\r\nfunction Scope(ref_obj, options) {\r\n\toptions || (options = {});\r\n\tvar self = this;\r\n\tself.id = $UID(\"SC\");\r\n\tself.E = {}; // events\r\n\tself.C = []; // children local scope 子集\r\n\tself.R = ref_obj || {}; // reference objects 参考对象\r\n\tvar store = options.store;\r\n\tself.O = $InsOf(store, $Object) ? store : $Object($InsOf(store, Object) ? store : {}); // object 作用域的变量集合\r\n\tself.setParent(options.parent); // pare scope 父级\r\n\tself.returner = null; // 这个作用域最后的返回值\r\n\r\n\tself.B = null; // block 块作用域，默认不激活，交给插件处理\r\n\r\n\tvar onerror = options.onerror;\r\n\tif ($InsOf(onerror, _GlobalFunction)) {\r\n\t\tself.on(\"error\", onerror);\r\n\t}\r\n};\r\n\r\nvar __ScopePrototype = Scope.prototype = {};\r\n__ScopePrototype.on = function (eventName, eventHandle) {\r\n\tvar self = this;\r\n\tvar events = self.E;\r\n\t$Push(events[eventName] || (events[eventName] = []), eventHandle);\r\n\treturn self;\r\n};\r\n__ScopePrototype.off = function (eventName, eventHandle) {\r\n\tvar self = this;\r\n\tvar events = self.E;\r\n\t$Remove(events[eventName] || (events[eventName] = []), eventHandle);\r\n\treturn self;\r\n};\r\n__ScopePrototype.emit = function (eventName) {\r\n\tvar self = this;\r\n\tvar eventList = $HasAndGet(self.E, eventName);\r\n\tif (eventList) {\r\n\t\tvar args = arguments.length > 1 && $Slice(arguments, 1);\r\n\t\t$ForEach(eventList, function (handle) {\r\n\t\t\targs ? handle.apply(self, args) : handle.call(this);\r\n\t\t});\r\n\t}\r\n\treturn self;\r\n};\r\n\r\n__ScopePrototype.push = function (scope_name) {\r\n\tvar self = this;\r\n\tvar child_scope = new Scope({}, {\r\n\t\tparent: self\r\n\t});\r\n\t$Push(self.C, child_scope);\r\n\r\n\tC_SP = child_scope;\r\n\treturn child_scope;\r\n};\r\n__ScopePrototype.pop = function (returner) {\r\n\tvar self = this;\r\n\tvar csp = $LastItem(self.C);\r\n\treturn csp && csp.destroy(returner);\r\n};\r\n\r\n__ScopePrototype.setParent = function (parent) {\r\n\tvar self = this;\r\n\tif (self.P = parent || null) {\r\n\t\tself.get = _ScopeNormalGet;\r\n\t\tself.set = _ScopeNormalSet;\r\n\t\tself.TypeOf = _ScopeNormalTypeOf;\r\n\t\tself.Del = _ScopeNormalDel;\r\n\t} else {\r\n\t\tself.get = _ScopeTopGet;\r\n\t\tself.set = _ScopeTopSet;\r\n\t\tself.TypeOf = _ScopeTopTypeOf;\r\n\t\tself.Del = _ScopeTopDel;\r\n\t}\r\n};\r\n__ScopePrototype.get = _ScopeNormalGet;\r\n\r\n/*\r\n * unpack: 是否解包，如果解包取出的对象默认是原生的JS对象，如果封包取出，则是内部存储的对象\r\n */\r\n/*GET*/\r\nfunction _ScopeNormalGet(key, unpack) {\r\n\tvar self = this;\r\n\treturn (self.O.has(key) ? self.O : self.P).get(key, unpack);\r\n};\r\n\r\nfunction _ScopeTopGet(key, unpack) { // 没有Parent对象的Get方法 no parent get \r\n\treturn this.O.get(key, unpack);\r\n};\r\n__ScopePrototype.set = _ScopeNormalSet;\r\n/*SET*/\r\nfunction _ScopeNormalSet(key, value) {\r\n\tvar self = this;\r\n\treturn (self.O.has(key) ? self.O : self.P).set(key, value);\r\n};\r\n\r\nfunction _ScopeTopSet(key, value) { // 没有Parent对象的Get方法 no parent get \r\n\treturn this.O.set(key, value);\r\n};\r\n__ScopePrototype.Var = _ScopeTopSet;\r\n/*TYPEOF*/\r\nfunction _ScopeNormalTypeOf(key) {\r\n\tvar self = this;\r\n\treturn (self.O.has(key) ? self.O : self.P).TypeOf(key);\r\n};\r\n\r\nfunction _ScopeTopTypeOf(key) { // 没有Parent对象的Get方法 no parent get \r\n\treturn this.O.TypeOf(key);\r\n};\r\n__ScopePrototype.TypeOf = _ScopeTopTypeOf;\r\n/*DELETE*/\r\nfunction _ScopeNormalDel(key) {\r\n\tvar self = this;\r\n\treturn (self.O.has(key) ? self.O : self.P).Del(key);\r\n};\r\n\r\nfunction _ScopeTopDel(key) { // 没有Parent对象的Get方法 no parent get \r\n\treturn this.O.Del(key);\r\n};\r\n__ScopePrototype.Del = _ScopeTopDel;\r\n\r\n// destroy 销毁作用域\r\n__ScopePrototype.destroy = function (returner) {\r\n\tvar self = this;\r\n\t// 注销事件监听\r\n\tself.E = null;\r\n\t// 销毁子集作用域\r\n\t$ForEach(self.C, function (csp) {\r\n\t\tcsp.destroy()\r\n\t});\r\n\tself.C = null;\r\n\t// 移除参考对象\r\n\tself.R = null;\r\n\t// 断开对象的引用，由系统垃圾回收器来进行回收\r\n\tself.O = null;\r\n\t// 断开与父级的关联\r\n\tif (self.P) {\r\n\t\tC_SP = self.P;\r\n\t\t$Remove(C_SP.C, self);\r\n\t\tself.P = null;\r\n\t}\r\n\r\n\t// 禁用这个作用域对象的所有方法。\r\n\tfor (var funName in __ScopePrototype) {\r\n\t\tself[funName] = _DestroyedHandle;\r\n\t}\r\n\r\n\tself.returner = returner;\r\n\treturn returner; // 直接返回返回值而不是被销毁的作用域。让作用域被CG直接回收\r\n};\r\n\r\nfunction _DestroyedHandle() {\r\n\tthrow ReferenceError(\"Scope objects has been destroyed.\");\r\n};\r\n\r\n\r\nvar C_SP = Scope.global = new Scope(global); //current Scope\r\n\r\nScope.current = function () {\r\n\treturn C_SP\r\n};\nScope.Boolean = $Boolean;\r\nfunction $$Boolean(v) {\r\n\tthis.V = v;\r\n};\r\n\r\n$$Boolean.TypeofValue = \"string\"\r\n\r\nvar __$$BooleanProperty = $$Boolean[__PROTOTYPE] = $Create(_$BaseProto);\r\n\r\n/*\r\n * true false 是系统常量\r\n */\r\n$true = new $$Boolean(TRUE);\r\n$false = new $$Boolean(FALSE);\r\n\r\nfunction $Boolean(v) {\r\n\treturn v ? $true : $false\r\n};\nScope.Function = $Function;\r\n\r\nfunction $$Function(fun, args) {\r\n\tthis.V = fun;\r\n\tthis.A = args;\r\n};\r\n\r\n$$Function.TypeofValue = \"function\"\r\n\r\nvar __$$FunctionProperty = $$Function[__PROTOTYPE] = $Create(_$BaseProto);\r\n__$$FunctionProperty.run = function (ctx, args) {\r\n\tvar self = this;\r\n\tself.V.apply(ctx, args);\r\n};\r\n\r\nfunction $Function(fun, args) {\r\n\treturn $$Function(fun, args)\r\n};\nScope.Null = $Null;\r\nfunction $$Null(v) {\r\n\tthis.V = v;\r\n};\r\n\r\n$$Null.TypeofValue = \"object\";\r\n\r\nvar __$$NullProperty = $$Null[__PROTOTYPE] = $Create(_$BaseProto);\r\n\r\n__$$NullProperty[__VALUEOF] = _Undefined_AND_Null_TypeError;\r\n__$$NullProperty[__TOSTRING] = _Undefined_AND_Null_TypeError;\r\n/*\r\n * null是一个系统常量\r\n */\r\nvar $null = new $$Null(null);\r\n\r\nfunction $Null() {\r\n\treturn $null\r\n};\nScope.Number = $Number;\r\n\r\nfunction $$Number(v) {\r\n\tthis.V = v;\r\n};\r\n\r\n$$Number.TypeofValue = \"number\"\r\n\r\nvar __$$NumberProperty = $$Number[__PROTOTYPE] = $Create(_$BaseProto);\r\n/*\r\n * 系统常量\r\n */\r\nvar $NaN = new $$Number(NaN);\r\n$NaN.equal = function () { // any value including NaN, 所以直接返回false\r\n\treturn FALSE\r\n};\r\nvar $Infinity = new $$Number(Infinity);\r\nvar $_Infinity = new $$Number(-Infinity);\r\n\r\nfunction $Number(v) {\r\n\tvar self;\r\n\tif (isNaN(v)) {\r\n\t\tself = $NaN;\r\n\t} else if (v === Infinity) {\r\n\t\tself = $Infinity\r\n\t} else if (v === -Infinity) {\r\n\t\tself = $_Infinity\r\n\t} else {\r\n\t\tself = new $$Number(v);\r\n\t}\r\n\treturn self\r\n};\nScope.Object = $Object;\r\n\r\nfunction $$Object(v) {\r\n\tthis.V = v;\r\n\tthis.G = null; //getter\r\n\tthis.S = null; //setter\r\n\tthis.C = {}; //config\r\n};\r\n$$Object.getProp = function (obj, key) {\r\n\tif ($InsOf(obj, $$Object) || $InsOf(obj, $String) || $InsOf(obj, $Number)) { //可用属性名进行优化\r\n\t\tvar res = obj.get(key)\r\n\t} else if (obj) {\r\n\t\tres = obj[key]\r\n\t}\r\n\treturn res;\r\n};\r\n\r\n$$Object.TypeofValue = \"object\"\r\n\r\nfunction _$$Object_Mix_HasProp(key) {\r\n\tvar self = this;\r\n\treturn $IsOwn(self.V, key) || $IsOwn(self.G, key) || $IsOwn(self.S, key);\r\n};\r\n\r\nfunction _$$Object_Mix_GetProp(key) {\r\n\tvar self = this;\r\n\tvar getter = self.G;\r\n\tvar value = self.V;\r\n\tif ($IsOwn(getter, key)) {\r\n\t\tvar res = getter[key].call(value, key)\r\n\t} else {\r\n\t\tres = value[key]\r\n\t}\r\n\treturn res\r\n};\r\n\r\nfunction _$$Object_Mix_SetProp(key, data, config) {\r\n\tvar self = this;\r\n\tvar setter = self.S;\r\n\tvar value = self.V;\r\n\tif ($IsOwn(setter, key)) {\r\n\t\tsetter[key].call(value, key, data)\r\n\t} else {\r\n\t\tvar config = self.C;\r\n\t\t/*TODO:根据config判断对象是否可被重写*/\r\n\t\tconfig[key] = config;\r\n\t\tvalue[key] = data\r\n\t}\r\n\treturn data\r\n};\r\n\r\nvar __$$ObjectProperty = $$Object[__PROTOTYPE] = $Create(_$BaseProto);\r\n__$$ObjectProperty.has = function (key) {\r\n\treturn $IsOwn(this.C, key)\r\n};\r\nfunction assignPropConfig(old_config, new_config) {\r\n\tnew_config || (new_config = {});\r\n\tvar res_config = {};\r\n\t$ForEach([\r\n\t\t\"enumerable\",\r\n\t\t\"configurable\",\r\n\t\t\"writable\"\r\n\t], function (key) {\r\n\t\tres_config[key] = !!($IsOwn(new_config, key) ? new_config : old_config)[key]\r\n\t});\r\n\treturn res_config;\r\n};\r\n//get Property\r\n__$$ObjectProperty.get = function (key, unpack) {\r\n\tvar self = this;\r\n\tif (self.has(key)) {\r\n\t\tvar res = self.G && $IsOwn(self.G, key) ? self.G[key].call(self.V) : self.V[key];\r\n\t} else {\r\n\t\tres = $undefined\r\n\t}\r\n\treturn unpack ? (res ? res.valueOf() : res) : $Base(res)\r\n};\r\n//set Property\r\n__$$ObjectProperty.set = function (key, value) {\r\n\tvar self = this;\r\n\t/*TODO:根据config判断对象是否可被重写*/\r\n\tvar old_config = self.C[key];\r\n\tif (old_config && ((!old_config.writable && $IsOwn(self.V, key)) || !old_config.configurable)) {\r\n\t\treturn\r\n\t}\r\n\t// 普通的变量定义，初始化默认的config\r\n\t$IsOwn(self.C, key) || (self.C[key] = assignPropConfig({\r\n\t\twritable: TRUE,\r\n\t\tenumerable: TRUE,\r\n\t\tconfigurable: TRUE\r\n\t}));\r\n\tvar V = $Base(value);\r\n\tself.S && $IsOwn(self.S, key) ? self.S[key].call(self.V, value) : (self.V[key] = value);\r\n\r\n\treturn V;\r\n};\r\n//define getter\r\n__$$ObjectProperty.defGet = function (key, handle, new_config) {\r\n\tvar self = this;\r\n\tvar getter = self.G || (self.G = {});\r\n\tvar old_config = self.C;\r\n\tif (!(handle instanceof Function)) {\r\n\t\tthrow TypeError(\"getter must be an function.\")\r\n\t}\r\n\t/*判断对象是否可被重写*/\r\n\tvar old_config = config[key];\r\n\tif (old_config && !old_config.configurable) {\r\n\t\treturn;\r\n\t}\r\n\tconfig[key] = assignPropConfig(old_config, new_config);\r\n\r\n\tgetter[key] = handle;\r\n\tdelete self.V[key];\r\n\tself.get = _$$Object_Mix_GetProp;\r\n\tself.has = _$$Object_Mix_HasProp;\r\n};\r\n//define setter\r\n__$$ObjectProperty.defSet = function (key, handle, new_config) {\r\n\tvar self = this;\r\n\tvar setter = self.S || (self.S = {});\r\n\tvar config = self.C;\r\n\tif (!(handle instanceof Function)) {\r\n\t\tthrow TypeError(\"setter must be an function.\")\r\n\t}\r\n\t/*判断对象是否可被重写*/\r\n\tvar old_config = config[key];\r\n\tif (old_config && !old_config.configurable) {\r\n\t\treturn;\r\n\t}\r\n\tconfig[key] = assignPropConfig(old_config, new_config);\r\n\r\n\tsetter[key] = handle;\r\n\tdelete self.V[key];\r\n\tself.set = _$$Object_Mix_SetProp;\r\n\tself.has = _$$Object_Mix_HasProp;\r\n};\r\n__$$ObjectProperty.def = function (key, config) {\r\n\tvar self = this;\r\n\tvar value = self.V;\r\n\tvar config = self.C || {};\r\n\r\n\t/*判断对象是否可被重写*/\r\n\tvar old_config = config[key];\r\n\tif (old_config && !old_config.configurable) {\r\n\t\treturn;\r\n\t}\r\n\tconfig[key] = assignPropConfig(old_config, config);\r\n\r\n\tif ($IsOwn(value, key) && old_config.writable) {\r\n\t\tif ($IsOwn(config, value)) {\r\n\t\t\tvalue[key] = config.value\r\n\t\t}\r\n\t\tself.C = assignPropConfig(config)\r\n\t} else if (old_config.configurable) {\r\n\t\tif ($IsOwn(config.get)) {\r\n\t\t\tvar setter = self.S || (self.S = {});\r\n\t\t\tgetter[key] = config.get;\r\n\t\t}\r\n\t\tif ($IsOwn(config.set)) {\r\n\t\t\tvar getter = self.G || (self.G = {});\r\n\t\t\tsetter[key] = config.set;\r\n\t\t}\r\n\t\tself.C = assignPropConfig(config)\r\n\t}\r\n\treturn self;\r\n};\r\n__$$ObjectProperty.Del = function (key) {\r\n\tvar self = this;\r\n\tvar config = self.C;\r\n\tvar value = self.V;\r\n\tvar getter = self.G;\r\n\tvar setter = self.S;\r\n\tvar res = TRUE;\r\n\tif ($IsOwn(config, key)) {\r\n\t\t/*TODO:根据config判断对象是否可被删除*/\r\n\t\t// res = config[key]\r\n\t\tgetter && delete getter[key];\r\n\t\tsetter && delete setter[key];\r\n\t\tdelete value[key];\r\n\t\tdelete config[key];\r\n\t}\r\n\treturn res\r\n};\r\n\r\nfunction $Object(v) {\r\n\treturn v === null ? $null : new $$Object(v);\r\n};\nScope.String = $String;\r\n\r\nfunction $$String(v) {\r\n\tthis.V = v;\r\n};\r\n\r\n$$String.TypeofValue = \"string\"\r\n\r\nvar __$$StringPrototype = $$String[__PROTOTYPE] = $Create(_$BaseProto);\r\n\r\n__$$StringPrototype.get = function (key) {\r\n\tvar self = this;\r\n\tvar value = self.V;\r\n\tif (isFinite(key) && key % 1 === 0) {\r\n\t\tvar res = value.charAt(key)\r\n\t} else {\r\n\t\tres = value[key]\r\n\t}\r\n\treturn res\r\n};\r\n__$$StringPrototype.set = function (key, obj) {\r\n\tvar self = this;\r\n\tvar value = self.V;\r\n\tif (!(isFinite(key) && key % 1 === 0)) {\r\n\t\tvalue[key] = obj\r\n\t}\r\n\treturn obj\r\n};\r\n\r\nfunction $String(v) {\r\n\treturn new $$String(v)\r\n};\nScope.Undefined = $Undefined;\r\nfunction $$Undefined(v) {\r\n\tthis.V = v;\r\n};\r\n$$Undefined.TypeofValue = \"undefined\";\r\n\r\nvar __$$UndefinedProperty = $$Undefined[__PROTOTYPE] = $Create(_$BaseProto);\r\n\r\n__$$UndefinedProperty[__VALUEOF] = _Undefined_AND_Null_TypeError;\r\n__$$UndefinedProperty[__TOSTRING] = _Undefined_AND_Null_TypeError;\r\n\r\n/*\r\n * undefined是一个系统常量\r\n */\r\nvar $undefined = new $$Undefined();\r\n\r\nfunction $Undefined() {\r\n\treturn $undefined\r\n};\n}));","(function (root, factory) {\r\n\tif (typeof define === 'function' && define.amd) {\r\n\t\tdefine([], function () {\r\n\t\t\treturn factory(root);\r\n\t\t});\r\n\t} else if (typeof exports === 'object') {\r\n\t\tvar exp = Object.create(null);\r\n\t\tfactory(exp);\r\n\t\t\tdebugger\r\n\t\tfor (var k in exp) {\r\n\t\t\texports[k] = root[k] = exp[k];\r\n\t\t}\r\n\t} else {\r\n\t\tfactory(root);\r\n\t}\r\n} (typeof global != 'undefined' ? global : typeof window != 'undefined' ? window : this, function (global) {\n/*\r\n * 更好的压缩率\r\n */\r\nvar __PROTOTYPE = \"prototype\";\r\nvar __VALUEOF = \"valueOf\";\r\nvar __TOSTRING = \"toString\";\r\nvar void_0;\r\nvar _GlobalFunction = Function;\r\nvar _GlobalArray = Array;\r\nvar _GlobalObject = Object;\r\nvar _GlobalRegExp = RegExp;\r\n\r\nvar TRUE = true;\r\nvar FALSE = false;\r\nvar NULL = null;\r\nvar UNDEFINED;\r\n// var NAN = NaN;\r\n// var INFINITY = Infinity;\r\n\r\nfunction $Push(arr, item) {\r\n\tarr[arr.length] = item;\r\n\treturn arr\r\n}\r\nfunction $Unshift(arr, item) {\r\n\tarr.unshift(item);\r\n\treturn arr\r\n};\r\n\r\nfunction $ForEach(arr, cb) {\r\n\tfor (var i = 0, len = arr.length; i < len; i += 1) {\r\n\t\tcb(arr[i], i)\r\n\t}\r\n}\r\n\r\nfunction $Map(arr, cb) {\r\n\tfor (var i = 0, len = arr.length, res = []; i < len; i += 1) {\r\n\t\t$Push(res, cb(arr[i], i))\r\n\t}\r\n\treturn res\r\n}\r\n\r\nfunction $Some(arr, cb) {\r\n\tfor (var i = 0, len = arr.length; i < len; i += 1) {\r\n\t\tif (cb(arr[i], i)) return TRUE\r\n\t}\r\n}\r\n\r\nvar _slice = Array[__PROTOTYPE].slice;\r\nvar __StringProto__ = String[__PROTOTYPE];\r\n\r\nfunction $Slice(arr, start_index, end_index) {\r\n\treturn _slice.call(arr, start_index, end_index);\r\n};\r\n\r\nfunction $Remove(arr, item) {\r\n\tvar index = arr.indexOf(item);\r\n\tindex !== -1 && arr.splice(index, 1);\r\n};\r\n\r\nfunction $HasAndGet(obj, key) {\r\n\treturn obj.hasOwnProperty(key) && obj[key];\r\n};\r\n\r\nvar _hasOwnPro = _GlobalObject.hasOwnProperty;\r\n\r\nfunction $IsOwn(obj, key) {\r\n\treturn _hasOwnPro.call(obj, key);\r\n};\r\n\r\nfunction $InsOf(obj, Con) {\r\n\treturn obj instanceof Con\r\n};\r\n\r\nfunction $IsString(str) {\r\n\treturn typeof str === \"string\"\r\n};\r\n\r\nfunction $IsNumber(num) {\r\n\treturn typeof num === \"number\"\r\n};\r\n\r\nfunction $IsBoolean(bool) {\r\n\treturn typeof bool === \"boolean\"\r\n};\r\n\r\nfunction $UID(prefix) {\r\n\treturn (prefix || \"\") + Math.random().toString(36).substr(2);\r\n};\r\n\r\nvar PROTO = _GlobalFunction();\r\n\r\nfunction $Create(proto) {\r\n\tPROTO[__PROTOTYPE] = proto;\r\n\treturn new PROTO;\r\n};\r\n\r\nfunction $LastItem(arr) {\r\n\treturn arr[arr.length - 1]\r\n};\r\n\r\nfunction noop() { }\r\n\r\n//将字符串反转义,同JSON.stringify(string)\r\nvar charIndexBuggy = \"a\"[0] != \"a\";\r\nvar Escapes = {\r\n\t92: \"\\\\\\\\\",\r\n\t34: '\\\\\"',\r\n\t8: \"\\\\b\",\r\n\t12: \"\\\\f\",\r\n\t10: \"\\\\n\",\r\n\t13: \"\\\\r\",\r\n\t9: \"\\\\t\"\r\n};\r\n\r\nfunction strStringify(value) {\r\n\tvar result = '\"',\r\n\t\tindex = 0,\r\n\t\tlength = value.length,\r\n\t\tuseCharIndex = !charIndexBuggy || length > 10;\r\n\tvar symbols = useCharIndex && (charIndexBuggy ? value.split(\"\") : value);\r\n\tfor (; index < length; index++) {\r\n\t\tvar charCode = value.charCodeAt(index);\r\n\t\t// If the character is a control character, append its Unicode or\r\n\t\t// shorthand escape sequence; otherwise, append the character as-is.\r\n\t\tswitch (charCode) {\r\n\t\t\tcase 8:\r\n\t\t\tcase 9:\r\n\t\t\tcase 10:\r\n\t\t\tcase 12:\r\n\t\t\tcase 13:\r\n\t\t\tcase 34:\r\n\t\t\tcase 92:\r\n\t\t\t\tresult += Escapes[charCode];\r\n\t\t\t\tbreak;\r\n\t\t\tdefault:\r\n\t\t\t\tif (charCode < 32) {\r\n\t\t\t\t\tresult += unicodePrefix + toPaddedString(2, charCode.toString(16));\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t\tresult += useCharIndex ? symbols[index] : value.charAt(index);\r\n\t\t}\r\n\t}\r\n\treturn result + '\"';\r\n};\nfunction _ReturnThisV() {\r\n\treturn this.V && this.V.valueOf();\r\n};\r\n\r\nfunction _ReturnThisVString() {\r\n\treturn this.V + \"\";\r\n};\r\n\r\nScope.Base = $Base;\r\n\r\nfunction $Base(obj) {\r\n\treturn $InsOf(obj, $Base) ? obj : _BaseTypeCusMap[typeof obj](obj)\r\n};\r\nvar _BaseTypeCusMap = {\r\n\t\"string\": $String,\r\n\t\"boolean\": $Boolean,\r\n\t\"number\": $Number,\r\n\t\"function\": $Function,\r\n\t\"undefined\": $Undefined,\r\n\t\"object\": function (v) {\r\n\t\treturn (v /*!== null */ ? $Object : $Null)(v)\r\n\t}\r\n};\r\n\r\nvar _$BaseProto = $Base[__PROTOTYPE] = {\r\n\thas: function (key) {\r\n\t\treturn $IsOwn(this.V, key)\r\n\t},\r\n\t//get Property\r\n\tget: function (key, unpack) {\r\n\t\tvar res = this.V[key];\r\n\t\t$InsOf(res, $Base) || (res = $undefined);// if false then\r\n\t\treturn unpack ? res.valueOf() : res\r\n\t},\r\n\t//set Property\r\n\tset: function (key, value) {\r\n\t\treturn this.V[key] = $Base(value);\r\n\t},\r\n\tTypeOf: function () {\r\n\t\treturn this.constructor.TypeofValue;\r\n\t},\r\n\tdestory: function () {\r\n\t\tdelete this.V;\r\n\t},\r\n\t// ===\r\n\tequal: function (obj) {\r\n\t\treturn this.V === ($InsOf(obj, $Base) ? obj.V : obj)\r\n\t},\r\n\tlike: function (obj) {\r\n\t\treturn this.V == ($InsOf(obj, $Base) ? obj.V : obj)\r\n\t}\r\n};\r\n_$BaseProto[__VALUEOF] = _ReturnThisV;\r\n_$BaseProto[__TOSTRING] = _ReturnThisVString;\r\n\r\n\r\nfunction _Undefined_AND_Null_TypeError() {\r\n\tthrow TypeError(\"Cannot convert undefined or null to object\");\r\n};\nglobal.jScope = Scope;\r\n\r\nfunction Scope(ref_obj, options) {\r\n\toptions || (options = {});\r\n\tvar self = this;\r\n\tself.id = $UID(\"SC\");\r\n\tself.E = {}; // events\r\n\tself.C = []; // children local scope 子集\r\n\tself.R = ref_obj || {}; // reference objects 参考对象\r\n\tvar store = options.store;\r\n\tself.O = $InsOf(store, $Object) ? store : $Object($InsOf(store, Object) ? store : {}); // object 作用域的变量集合\r\n\tself.setParent(options.parent); // pare scope 父级\r\n\tself.returner = null; // 这个作用域最后的返回值\r\n\r\n\tself.B = null; // block 块作用域，默认不激活，交给插件处理\r\n\r\n\tvar onerror = options.onerror;\r\n\tif ($InsOf(onerror, _GlobalFunction)) {\r\n\t\tself.on(\"error\", onerror);\r\n\t}\r\n};\r\n\r\nvar __ScopePrototype = Scope.prototype = {};\r\n__ScopePrototype.on = function (eventName, eventHandle) {\r\n\tvar self = this;\r\n\tvar events = self.E;\r\n\t$Push(events[eventName] || (events[eventName] = []), eventHandle);\r\n\treturn self;\r\n};\r\n__ScopePrototype.off = function (eventName, eventHandle) {\r\n\tvar self = this;\r\n\tvar events = self.E;\r\n\t$Remove(events[eventName] || (events[eventName] = []), eventHandle);\r\n\treturn self;\r\n};\r\n__ScopePrototype.emit = function (eventName) {\r\n\tvar self = this;\r\n\tvar eventList = $HasAndGet(self.E, eventName);\r\n\tif (eventList) {\r\n\t\tvar args = arguments.length > 1 && $Slice(arguments, 1);\r\n\t\t$ForEach(eventList, function (handle) {\r\n\t\t\targs ? handle.apply(self, args) : handle.call(this);\r\n\t\t});\r\n\t}\r\n\treturn self;\r\n};\r\n\r\n__ScopePrototype.push = function (scope_name) {\r\n\tvar self = this;\r\n\tvar child_scope = new Scope({}, {\r\n\t\tparent: self\r\n\t});\r\n\t$Push(self.C, child_scope);\r\n\r\n\tC_SP = child_scope;\r\n\treturn child_scope;\r\n};\r\n__ScopePrototype.pop = function (returner) {\r\n\tvar self = this;\r\n\tvar csp = $LastItem(self.C);\r\n\treturn csp && csp.destroy(returner);\r\n};\r\n\r\n__ScopePrototype.setParent = function (parent) {\r\n\tvar self = this;\r\n\tif (self.P = parent || null) {\r\n\t\tself.get = _ScopeNormalGet;\r\n\t\tself.set = _ScopeNormalSet;\r\n\t\tself.TypeOf = _ScopeNormalTypeOf;\r\n\t\tself.Del = _ScopeNormalDel;\r\n\t} else {\r\n\t\tself.get = _ScopeTopGet;\r\n\t\tself.set = _ScopeTopSet;\r\n\t\tself.TypeOf = _ScopeTopTypeOf;\r\n\t\tself.Del = _ScopeTopDel;\r\n\t}\r\n};\r\n__ScopePrototype.get = _ScopeNormalGet;\r\n\r\n/*\r\n * unpack: 是否解包，如果解包取出的对象默认是原生的JS对象，如果封包取出，则是内部存储的对象\r\n */\r\n/*GET*/\r\nfunction _ScopeNormalGet(key, unpack) {\r\n\tvar self = this;\r\n\treturn (self.O.has(key) ? self.O : self.P).get(key, unpack);\r\n};\r\n\r\nfunction _ScopeTopGet(key, unpack) { // 没有Parent对象的Get方法 no parent get \r\n\treturn this.O.get(key, unpack);\r\n};\r\n__ScopePrototype.set = _ScopeNormalSet;\r\n/*SET*/\r\nfunction _ScopeNormalSet(key, value) {\r\n\tvar self = this;\r\n\treturn (self.O.has(key) ? self.O : self.P).set(key, value);\r\n};\r\n\r\nfunction _ScopeTopSet(key, value) { // 没有Parent对象的Get方法 no parent get \r\n\treturn this.O.set(key, value);\r\n};\r\n__ScopePrototype.Var = _ScopeTopSet;\r\n/*TYPEOF*/\r\nfunction _ScopeNormalTypeOf(key) {\r\n\tvar self = this;\r\n\treturn (self.O.has(key) ? self.O : self.P).TypeOf(key);\r\n};\r\n\r\nfunction _ScopeTopTypeOf(key) { // 没有Parent对象的Get方法 no parent get \r\n\treturn this.O.TypeOf(key);\r\n};\r\n__ScopePrototype.TypeOf = _ScopeTopTypeOf;\r\n/*DELETE*/\r\nfunction _ScopeNormalDel(key) {\r\n\tvar self = this;\r\n\treturn (self.O.has(key) ? self.O : self.P).Del(key);\r\n};\r\n\r\nfunction _ScopeTopDel(key) { // 没有Parent对象的Get方法 no parent get \r\n\treturn this.O.Del(key);\r\n};\r\n__ScopePrototype.Del = _ScopeTopDel;\r\n\r\n// destroy 销毁作用域\r\n__ScopePrototype.destroy = function (returner) {\r\n\tvar self = this;\r\n\t// 注销事件监听\r\n\tself.E = null;\r\n\t// 销毁子集作用域\r\n\t$ForEach(self.C, function (csp) {\r\n\t\tcsp.destroy()\r\n\t});\r\n\tself.C = null;\r\n\t// 移除参考对象\r\n\tself.R = null;\r\n\t// 断开对象的引用，由系统垃圾回收器来进行回收\r\n\tself.O = null;\r\n\t// 断开与父级的关联\r\n\tif (self.P) {\r\n\t\tC_SP = self.P;\r\n\t\t$Remove(C_SP.C, self);\r\n\t\tself.P = null;\r\n\t}\r\n\r\n\t// 禁用这个作用域对象的所有方法。\r\n\tfor (var funName in __ScopePrototype) {\r\n\t\tself[funName] = _DestroyedHandle;\r\n\t}\r\n\r\n\tself.returner = returner;\r\n\treturn returner; // 直接返回返回值而不是被销毁的作用域。让作用域被CG直接回收\r\n};\r\n\r\nfunction _DestroyedHandle() {\r\n\tthrow ReferenceError(\"Scope objects has been destroyed.\");\r\n};\r\n\r\n\r\nvar C_SP = Scope.global = new Scope(global); //current Scope\r\n\r\nScope.current = function () {\r\n\treturn C_SP\r\n};\nScope.Boolean = $Boolean;\r\nfunction $$Boolean(v) {\r\n\tthis.V = v;\r\n};\r\n\r\n$$Boolean.TypeofValue = \"string\"\r\n\r\nvar __$$BooleanProperty = $$Boolean[__PROTOTYPE] = $Create(_$BaseProto);\r\n\r\n/*\r\n * true false 是系统常量\r\n */\r\n$true = new $$Boolean(TRUE);\r\n$false = new $$Boolean(FALSE);\r\n\r\nfunction $Boolean(v) {\r\n\treturn v ? $true : $false\r\n};\nScope.Function = $Function;\r\n\r\nfunction $$Function(fun, args) {\r\n\tthis.V = fun;\r\n\tthis.A = args;\r\n};\r\n\r\n$$Function.TypeofValue = \"function\"\r\n\r\nvar __$$FunctionProperty = $$Function[__PROTOTYPE] = $Create(_$BaseProto);\r\n__$$FunctionProperty.run = function (ctx, args) {\r\n\tvar self = this;\r\n\tself.V.apply(ctx, args);\r\n};\r\n\r\nfunction $Function(fun, args) {\r\n\treturn $$Function(fun, args)\r\n};\nScope.Null = $Null;\r\nfunction $$Null(v) {\r\n\tthis.V = v;\r\n};\r\n\r\n$$Null.TypeofValue = \"object\";\r\n\r\nvar __$$NullProperty = $$Null[__PROTOTYPE] = $Create(_$BaseProto);\r\n\r\n__$$NullProperty[__VALUEOF] = _Undefined_AND_Null_TypeError;\r\n__$$NullProperty[__TOSTRING] = _Undefined_AND_Null_TypeError;\r\n/*\r\n * null是一个系统常量\r\n */\r\nvar $null = new $$Null(null);\r\n\r\nfunction $Null() {\r\n\treturn $null\r\n};\nScope.Number = $Number;\r\n\r\nfunction $$Number(v) {\r\n\tthis.V = v;\r\n};\r\n\r\n$$Number.TypeofValue = \"number\"\r\n\r\nvar __$$NumberProperty = $$Number[__PROTOTYPE] = $Create(_$BaseProto);\r\n/*\r\n * 系统常量\r\n */\r\nvar $NaN = new $$Number(NaN);\r\n$NaN.equal = function () { // any value including NaN, 所以直接返回false\r\n\treturn FALSE\r\n};\r\nvar $Infinity = new $$Number(Infinity);\r\nvar $_Infinity = new $$Number(-Infinity);\r\n\r\nfunction $Number(v) {\r\n\tvar self;\r\n\tif (isNaN(v)) {\r\n\t\tself = $NaN;\r\n\t} else if (v === Infinity) {\r\n\t\tself = $Infinity\r\n\t} else if (v === -Infinity) {\r\n\t\tself = $_Infinity\r\n\t} else {\r\n\t\tself = new $$Number(v);\r\n\t}\r\n\treturn self\r\n};\nScope.Object = $Object;\r\n\r\nfunction $$Object(v) {\r\n\tthis.V = v;\r\n\tthis.G = null; //getter\r\n\tthis.S = null; //setter\r\n\tthis.C = {}; //config\r\n};\r\n$$Object.getProp = function (obj, key) {\r\n\tif ($InsOf(obj, $$Object) || $InsOf(obj, $String) || $InsOf(obj, $Number)) { //可用属性名进行优化\r\n\t\tvar res = obj.get(key)\r\n\t} else if (obj) {\r\n\t\tres = obj[key]\r\n\t}\r\n\treturn res;\r\n};\r\n\r\n$$Object.TypeofValue = \"object\"\r\n\r\nfunction _$$Object_Mix_HasProp(key) {\r\n\tvar self = this;\r\n\treturn $IsOwn(self.V, key) || $IsOwn(self.G, key) || $IsOwn(self.S, key);\r\n};\r\n\r\nfunction _$$Object_Mix_GetProp(key) {\r\n\tvar self = this;\r\n\tvar getter = self.G;\r\n\tvar value = self.V;\r\n\tif ($IsOwn(getter, key)) {\r\n\t\tvar res = getter[key].call(value, key)\r\n\t} else {\r\n\t\tres = value[key]\r\n\t}\r\n\treturn res\r\n};\r\n\r\nfunction _$$Object_Mix_SetProp(key, data, config) {\r\n\tvar self = this;\r\n\tvar setter = self.S;\r\n\tvar value = self.V;\r\n\tif ($IsOwn(setter, key)) {\r\n\t\tsetter[key].call(value, key, data)\r\n\t} else {\r\n\t\tvar config = self.C;\r\n\t\t/*TODO:根据config判断对象是否可被重写*/\r\n\t\tconfig[key] = config;\r\n\t\tvalue[key] = data\r\n\t}\r\n\treturn data\r\n};\r\n\r\nvar __$$ObjectProperty = $$Object[__PROTOTYPE] = $Create(_$BaseProto);\r\n__$$ObjectProperty.has = function (key) {\r\n\treturn $IsOwn(this.C, key)\r\n};\r\nfunction assignPropConfig(old_config, new_config) {\r\n\tnew_config || (new_config = {});\r\n\tvar res_config = {};\r\n\t$ForEach([\r\n\t\t\"enumerable\",\r\n\t\t\"configurable\",\r\n\t\t\"writable\"\r\n\t], function (key) {\r\n\t\tres_config[key] = !!($IsOwn(new_config, key) ? new_config : old_config)[key]\r\n\t});\r\n\treturn res_config;\r\n};\r\n//get Property\r\n__$$ObjectProperty.get = function (key, unpack) {\r\n\tvar self = this;\r\n\tif (self.has(key)) {\r\n\t\tvar res = self.G && $IsOwn(self.G, key) ? self.G[key].call(self.V) : self.V[key];\r\n\t} else {\r\n\t\tres = $undefined\r\n\t}\r\n\treturn unpack ? (res ? res.valueOf() : res) : $Base(res)\r\n};\r\n//set Property\r\n__$$ObjectProperty.set = function (key, value) {\r\n\tvar self = this;\r\n\t/*TODO:根据config判断对象是否可被重写*/\r\n\tvar old_config = self.C[key];\r\n\tif (old_config && ((!old_config.writable && $IsOwn(self.V, key)) || !old_config.configurable)) {\r\n\t\treturn\r\n\t}\r\n\t// 普通的变量定义，初始化默认的config\r\n\t$IsOwn(self.C, key) || (self.C[key] = assignPropConfig({\r\n\t\twritable: TRUE,\r\n\t\tenumerable: TRUE,\r\n\t\tconfigurable: TRUE\r\n\t}));\r\n\tvar V = $Base(value);\r\n\tself.S && $IsOwn(self.S, key) ? self.S[key].call(self.V, value) : (self.V[key] = value);\r\n\r\n\treturn V;\r\n};\r\n//define getter\r\n__$$ObjectProperty.defGet = function (key, handle, new_config) {\r\n\tvar self = this;\r\n\tvar getter = self.G || (self.G = {});\r\n\tvar old_config = self.C;\r\n\tif (!(handle instanceof Function)) {\r\n\t\tthrow TypeError(\"getter must be an function.\")\r\n\t}\r\n\t/*判断对象是否可被重写*/\r\n\tvar old_config = config[key];\r\n\tif (old_config && !old_config.configurable) {\r\n\t\treturn;\r\n\t}\r\n\tconfig[key] = assignPropConfig(old_config, new_config);\r\n\r\n\tgetter[key] = handle;\r\n\tdelete self.V[key];\r\n\tself.get = _$$Object_Mix_GetProp;\r\n\tself.has = _$$Object_Mix_HasProp;\r\n};\r\n//define setter\r\n__$$ObjectProperty.defSet = function (key, handle, new_config) {\r\n\tvar self = this;\r\n\tvar setter = self.S || (self.S = {});\r\n\tvar config = self.C;\r\n\tif (!(handle instanceof Function)) {\r\n\t\tthrow TypeError(\"setter must be an function.\")\r\n\t}\r\n\t/*判断对象是否可被重写*/\r\n\tvar old_config = config[key];\r\n\tif (old_config && !old_config.configurable) {\r\n\t\treturn;\r\n\t}\r\n\tconfig[key] = assignPropConfig(old_config, new_config);\r\n\r\n\tsetter[key] = handle;\r\n\tdelete self.V[key];\r\n\tself.set = _$$Object_Mix_SetProp;\r\n\tself.has = _$$Object_Mix_HasProp;\r\n};\r\n__$$ObjectProperty.def = function (key, config) {\r\n\tvar self = this;\r\n\tvar value = self.V;\r\n\tvar config = self.C || {};\r\n\r\n\t/*判断对象是否可被重写*/\r\n\tvar old_config = config[key];\r\n\tif (old_config && !old_config.configurable) {\r\n\t\treturn;\r\n\t}\r\n\tconfig[key] = assignPropConfig(old_config, config);\r\n\r\n\tif ($IsOwn(value, key) && old_config.writable) {\r\n\t\tif ($IsOwn(config, value)) {\r\n\t\t\tvalue[key] = config.value\r\n\t\t}\r\n\t\tself.C = assignPropConfig(config)\r\n\t} else if (old_config.configurable) {\r\n\t\tif ($IsOwn(config.get)) {\r\n\t\t\tvar setter = self.S || (self.S = {});\r\n\t\t\tgetter[key] = config.get;\r\n\t\t}\r\n\t\tif ($IsOwn(config.set)) {\r\n\t\t\tvar getter = self.G || (self.G = {});\r\n\t\t\tsetter[key] = config.set;\r\n\t\t}\r\n\t\tself.C = assignPropConfig(config)\r\n\t}\r\n\treturn self;\r\n};\r\n__$$ObjectProperty.Del = function (key) {\r\n\tvar self = this;\r\n\tvar config = self.C;\r\n\tvar value = self.V;\r\n\tvar getter = self.G;\r\n\tvar setter = self.S;\r\n\tvar res = TRUE;\r\n\tif ($IsOwn(config, key)) {\r\n\t\t/*TODO:根据config判断对象是否可被删除*/\r\n\t\t// res = config[key]\r\n\t\tgetter && delete getter[key];\r\n\t\tsetter && delete setter[key];\r\n\t\tdelete value[key];\r\n\t\tdelete config[key];\r\n\t}\r\n\treturn res\r\n};\r\n\r\nfunction $Object(v) {\r\n\treturn v === null ? $null : new $$Object(v);\r\n};\nScope.String = $String;\r\n\r\nfunction $$String(v) {\r\n\tthis.V = v;\r\n};\r\n\r\n$$String.TypeofValue = \"string\"\r\n\r\nvar __$$StringPrototype = $$String[__PROTOTYPE] = $Create(_$BaseProto);\r\n\r\n__$$StringPrototype.get = function (key) {\r\n\tvar self = this;\r\n\tvar value = self.V;\r\n\tif (isFinite(key) && key % 1 === 0) {\r\n\t\tvar res = value.charAt(key)\r\n\t} else {\r\n\t\tres = value[key]\r\n\t}\r\n\treturn res\r\n};\r\n__$$StringPrototype.set = function (key, obj) {\r\n\tvar self = this;\r\n\tvar value = self.V;\r\n\tif (!(isFinite(key) && key % 1 === 0)) {\r\n\t\tvalue[key] = obj\r\n\t}\r\n\treturn obj\r\n};\r\n\r\nfunction $String(v) {\r\n\treturn new $$String(v)\r\n};\nScope.Undefined = $Undefined;\r\nfunction $$Undefined(v) {\r\n\tthis.V = v;\r\n};\r\n$$Undefined.TypeofValue = \"undefined\";\r\n\r\nvar __$$UndefinedProperty = $$Undefined[__PROTOTYPE] = $Create(_$BaseProto);\r\n\r\n__$$UndefinedProperty[__VALUEOF] = _Undefined_AND_Null_TypeError;\r\n__$$UndefinedProperty[__TOSTRING] = _Undefined_AND_Null_TypeError;\r\n\r\n/*\r\n * undefined是一个系统常量\r\n */\r\nvar $undefined = new $$Undefined();\r\n\r\nfunction $Undefined() {\r\n\treturn $undefined\r\n};\n}));"],"sourceRoot":"/source/"}